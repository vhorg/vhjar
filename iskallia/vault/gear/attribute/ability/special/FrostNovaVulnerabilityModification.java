package iskallia.vault.gear.attribute.ability.special;

import com.google.gson.JsonArray;
import iskallia.vault.VaultMod;
import iskallia.vault.gear.attribute.VaultGearModifier;
import iskallia.vault.gear.attribute.ability.special.base.SpecialAbilityGearAttribute;
import iskallia.vault.gear.attribute.ability.special.base.template.IntRangeModification;
import iskallia.vault.gear.attribute.ability.special.base.template.value.IntValue;
import javax.annotation.Nullable;
import net.minecraft.network.chat.MutableComponent;
import net.minecraft.network.chat.Style;
import net.minecraft.network.chat.TextComponent;
import net.minecraft.resources.ResourceLocation;

public class FrostNovaVulnerabilityModification extends IntRangeModification {
   public static final ResourceLocation ID = VaultMod.id("frost_nova_vulnerability");

   public FrostNovaVulnerabilityModification() {
      super(ID);
   }

   @Nullable
   @Override
   public MutableComponent getDisplay(SpecialAbilityGearAttribute<?, IntValue> instance, Style style, VaultGearModifier.AffixType type) {
      MutableComponent valueDisplay = this.getValueDisplay(instance.getValue());
      return valueDisplay == null
         ? null
         : new TextComponent("")
            .append(type.getAffixPrefixComponent(true))
            .append("Frost Nova also applies Level ")
            .append(valueDisplay.withStyle(instance.getHighlightStyle()))
            .append(" Vulnerability")
            .setStyle(instance.getTextStyle());
   }

   @Override
   public void serializeTextElements(JsonArray out, SpecialAbilityGearAttribute<?, IntValue> instance, VaultGearModifier.AffixType type) {
      MutableComponent valueDisplay = this.getValueDisplay(instance.getValue());
      if (valueDisplay != null) {
         out.add(type.getAffixPrefix(true));
         out.add("Frost Nova also applies Level ");
         out.add(valueDisplay.getString());
         out.add(" Vulnerability");
      }
   }
}
